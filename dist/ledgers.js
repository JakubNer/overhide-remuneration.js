!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("web3")):"function"==typeof define&&define.amd?define("__oh$__",["web3"],t):"object"==typeof exports?exports.__oh$__=t(require("web3")):e.__oh$__=t(e.Web3)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise(function(a,i){var o=e.apply(t,r);function u(e){n(o,a,i,u,s,"next",e)}function s(e){n(o,a,i,u,s,"throw",e)}u(void 0)})}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,r=null,n=[{key:"getTxs_check_details",value:function(e,t){if(t&&!(t instanceof Date))throw new Error("'date' must be a Date is passed in");if(!("address"in e&&e.address))throw new Error("'address' required in recipient")}},{key:"getTxs_retrieve",value:function(){var e=a(regeneratorRuntime.mark(function e(t,r,n,a,i,o,u,s){var c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 2:return c="",o&&(c="&since=".concat(o.toISOString())),l="",i&&(l="&tally-dollars=true"),e.next=8,s("".concat(t,"/get-transactions/").concat(r,"/").concat(n,"?tally-only=").concat(a?"true":"false").concat(l).concat(c,"&include-refunds=true"),{headers:new Headers({Authorization:"Bearer ".concat(u)})}).then(function(e){return e.json()}).catch(function(e){throw String(e)});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t,r,n,a,i,o,u,s){return e.apply(this,arguments)}}()},{key:"isSignatureValid_call",value:function(){var e=a(regeneratorRuntime.mark(function e(t,r,n,a,i,o){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("".concat(t,"/is-signature-valid"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(i)},body:JSON.stringify({signature:btoa(r),message:btoa(n),address:a})}).then(function(e){return 200==e.status}).catch(function(e){throw String(e)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,r,n,a,i,o){return e.apply(this,arguments)}}()}],r&&i(t.prototype,r),n&&i(t,n),e}();t.a=o},function(e,t,r){"use strict";var n=r(0);function a(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function u(e){a(o,n,i,u,s,"next",e)}function s(e){a(o,n,i,u,s,"throw",e)}u(void 0)})}}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(){function e(t,r,n,a){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"remuneration_uri",{main:"https://ethereum.overhide.io",rinkeby:"https://rinkeby.ethereum.overhide.io"}),this.web3_wallet=t,this.eth_accounts=t.eth_accounts,this.getToken=r,this.__fetch=n,this.fire=a,t.networkChangeDelegates.push(function(e){return i.onNetworkChange(e)})}var t,r,a;return t=e,(r=[{key:"onNetworkChange",value:function(t){this.fire("onNetworkChange",{imparterTag:e.tag,name:t,uri:this.remuneration_uri[t]})}},{key:"canSetCredentials",value:function(){return!1}},{key:"canGenerateCredentials",value:function(){return!1}},{key:"canChangeNetwork",value:function(){return!1}},{key:"setCredentials",value:function(e){return!1}},{key:"getCredentials",value:function(){return{address:this.web3_wallet.walletAddress}}},{key:"generateCredentials",value:function(e){return!1}},{key:"setNetwork",value:function(e){return!1}},{key:"getNetwork",value:function(){return{name:this.web3_wallet.network,uri:this.remuneration_uri[this.web3_wallet.network]}}},{key:"getOverhideRemunerationAPIUri",value:function(){return this.remuneration_uri[this.web3_wallet.network]}},{key:"getFromDollars",value:function(){var e=i(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="main"===this.web3_wallet.network?"":"test.",n=(new Date).toISOString(),e.next=4,this.__fetch("https://".concat(r,"rates.overhide.io/rates/wei/").concat(n),{headers:new Headers({Authorization:"Bearer ".concat(this.getToken())})}).then(function(e){return e.json()}).catch(function(e){throw String(e)});case 4:if((a=e.sent)&&0!==a.length&&!(!1 in a[0])&&0!==a[0].minrate){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",t/a[0].minrate);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=i(regeneratorRuntime.mark(function e(t,r,a,i){var o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.a.getTxs_check_details(t,r),o=t.address,u=this.getOverhideRemunerationAPIUri(),this.web3_wallet.network){e.next=5;break}throw new Error("network must be set in wallet");case 5:if(this.web3_wallet.walletAddress){e.next=7;break}throw new Error("from 'walletAddress' not set: use wallet");case 7:return s=this.web3_wallet.walletAddress,e.next=10,n.a.getTxs_retrieve(u,s,o,a,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=i(regeneratorRuntime.mark(function e(){var t,r,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.web3_wallet.network){e.next=3;break}throw new Error("no network for imparter tag");case 3:if(this.web3_wallet.walletAddress){e.next=5;break}throw new Error("from 'walletAddress' not set: use wallet");case 5:if(r=this.web3_wallet.walletAddress,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return a="verify ownership of address by signing",e.next=11,this.sign(a);case 11:return i=e.sent,e.next=14,n.a.isSignatureValid_call(t,i,a,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=i(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.web3_wallet.walletAddress){t.next=2;break}throw new Error("imparter ".concat(e.tag," not active"));case 2:return this.fire("onWalletPopup",{imparterTag:e.tag}),t.next=5,window.web3.eth.personal.sign(r,this.web3_wallet.walletAddress,"");case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var t=i(regeneratorRuntime.mark(function t(r,n,a){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.web3_wallet.network){t.next=2;break}throw new Error("no network for imparter tag");case 2:if(this.web3_wallet.walletAddress){t.next=4;break}throw new Error("from 'walletAddress' not set: use wallet");case 4:return i=this.web3_wallet.walletAddress,this.getOverhideRemunerationAPIUri(),this.fire("onWalletPopup",{imparterTag:e.tag}),t.next=9,new Promise(function(e,t){window.web3.eth.sendTransaction({from:i,to:n,value:r}).on("confirmation",function(t,r){e()}).on("error",function(e){t(e)})});case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}},t,this)}));return function(e,r,n){return t.apply(this,arguments)}}()}])&&o(t.prototype,r),a&&o(t,a),e}();u(s,"tag","eth-web3"),t.a=s},function(e,t,r){"use strict";var n=r(3),a=r(0);function i(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function u(e){i(o,n,a,u,s,"next",e)}function s(e){i(o,n,a,u,s,"throw",e)}u(void 0)})}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t,r,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"mode","test"),this.web3_wallet=r,this.overhide_wallet=t,this.__fetch=a,this.getToken=n,this.fire=i}var t,r,i;return t=e,(r=[{key:"canSetCredentials",value:function(){return!1}},{key:"canGenerateCredentials",value:function(){return!1}},{key:"canChangeNetwork",value:function(){return!0}},{key:"setCredentials",value:function(e){return!1}},{key:"getCredentials",value:function(){return{address:this.web3_wallet.walletAddress}}},{key:"generateCredentials",value:function(e){return!1}},{key:"setNetwork",value:function(t){return n.a.setNetwork_check_details(t),this.mode=t.mode,this.fire("onNetworkChange",{imparterTag:e.tag,currency:"USD",mode:t.mode,uri:this.overhide_wallet.remuneration_uri[t.mode]}),!0}},{key:"getNetwork",value:function(){return{currency:"USD",mode:this.mode,uri:this.overhide_wallet.remuneration_uri[this.mode]}}},{key:"getOverhideRemunerationAPIUri",value:function(){if(!this.mode)throw new Error("network 'mode' must be set, use setNetwork");return this.overhide_wallet.remuneration_uri[this.mode]}},{key:"getFromDollars",value:function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",100*t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,n,i){var o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.a.getTxs_check_details(t,r),o=t.address,u=this.getOverhideRemunerationAPIUri(),this.mode){e.next=5;break}throw new Error("network 'mode' must be set, use setNetwork");case 5:if(this.web3_wallet.walletAddress){e.next=7;break}throw new Error("from 'walletAddress' not set: use wallet");case 7:return s=this.web3_wallet.walletAddress,e.next=10,a.a.getTxs_retrieve(u,s,o,n,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=o(regeneratorRuntime.mark(function e(){var t,r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.mode){e.next=3;break}throw new Error("network 'mode' must be set, use setNetwork");case 3:if(this.web3_wallet.walletAddress){e.next=5;break}throw new Error("from 'walletAddress' not set: use wallet");case 5:if(r=this.web3_wallet.walletAddress,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return n="verify ownership of address by signing",e.next=11,this.sign(n);case 11:return i=e.sent,e.next=14,a.a.isSignatureValid_call(t,i,n,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=o(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.web3_wallet.walletAddress){t.next=2;break}throw new Error("imparter ".concat(e.tag," not active"));case 2:return this.fire("onWalletPopup",{imparterTag:e.tag}),t.next=5,window.web3.eth.personal.sign(r,this.web3_wallet.walletAddress,"");case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,a){var i,o,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode){e.next=2;break}throw new Error("network 'mode' must be set, use setNetwork");case 2:if(this.web3_wallet.walletAddress){e.next=4;break}throw new Error("from 'walletAddress' not set: use wallet");case 4:return i=this.web3_wallet.walletAddress,o=this.getOverhideRemunerationAPIUri(),e.next=8,n.a.createTransaction(t,i,r,function(e){return u.sign(e)},function(e,t,r){return u.overhide_wallet.showOhLedgerGratisIframeUri(o,e,t,r)},this.overhide_wallet.oh_ledger_transact_fn[this.mode],a);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()}])&&u(t.prototype,r),i&&u(t,i),e}();s(c,"tag","ohledger-web3"),t.a=c},function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,r=null,i=[{key:"setNetwork_check_details",value:function(e){if(!("currency"in e))throw new Error("'currency' must be passed in");if(!("mode"in e))throw new Error("'mode' must be passed in");if(e.currency=e.currency.toUpperCase(),e.mode=e.mode.toLowerCase(),"USD"!==e.currency)throw new Error("'currency' must be 'USD'");if("prod"!==e.mode&&"test"!==e.mode)throw new Error("'mode' must be 'prod' or 'test'")}},{key:"createTransaction",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t,r,n,a,i,o,u){var s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t){e.next=14;break}if(!("message"in u&&u.message&&"signature"in u&&u.signature)){e.next=6;break}s=u.message,c=u.signature,e.next=10;break;case 6:return s="verify ownership of address by signing on ".concat((new Date).toLocaleString()),e.next=9,a(s);case 9:c=e.sent;case 10:return e.next=12,i(r,c,s);case 12:e.next=16;break;case 14:return e.next=16,o(t,r,n);case 16:case"end":return e.stop()}},e)}),function(){var t=this,r=arguments;return new Promise(function(a,i){var o=e.apply(t,r);function u(e){n(o,a,i,u,s,"next",e)}function s(e){n(o,a,i,u,s,"throw",e)}u(void 0)})});return function(e,r,n,a,i,o,u){return t.apply(this,arguments)}}()}],r&&a(t.prototype,r),i&&a(t,i),e}();t.a=i},function(e,t,r){"use strict";var n=r(3),a=r(0);function i(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function u(e){i(o,n,a,u,s,"next",e)}function s(e){i(o,n,a,u,s,"throw",e)}u(void 0)})}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t,r,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"address",null),s(this,"secret",null),s(this,"mode","test"),this.overhide_wallet=t,this.eth_accounts=r.eth_accounts,this.getToken=n,this.__fetch=a,this.fire=i}var t,r,i;return t=e,(r=[{key:"canSetCredentials",value:function(){return!0}},{key:"canGenerateCredentials",value:function(){return!0}},{key:"canChangeNetwork",value:function(){return!0}},{key:"setCredentials",value:function(t){if(!("secret"in t))throw new Error("'secret' must be passed in");"address"in t&&t.address?this.address=t.address.toLowerCase():this.address=this.eth_accounts.privateKeyToAccount(t.secret).address.toLowerCase(),this.secret=t.secret;try{if(this.eth_accounts.recover(this.eth_accounts.sign("test message",this.secret)).toLowerCase()!=this.address)throw new Error("'secret' not valid for 'address")}catch(e){throw new Error("'secret' not valid for 'address")}return this.fire("onCredentialsUpdate",{imparterTag:e.tag,address:this.address,secret:this.secret}),!0}},{key:"getCredentials",value:function(){return{address:this.address,secret:this.secret}}},{key:"generateCredentials",value:function(t){var r=this.eth_accounts.create();return this.address=r.address.toLowerCase(),this.secret=r.privateKey,this.fire("onCredentialsUpdate",{imparterTag:e.tag,address:this.address,secret:this.secret}),!0}},{key:"setNetwork",value:function(t){return n.a.setNetwork_check_details(t),this.mode=t.mode,this.fire("onNetworkChange",{imparterTag:e.tag,currency:"USD",mode:t.mode,uri:this.overhide_wallet.remuneration_uri[t.mode]}),!0}},{key:"getNetwork",value:function(){return{currency:"USD",mode:this.mode,uri:this.overhide_wallet.remuneration_uri[this.mode]}}},{key:"getOverhideRemunerationAPIUri",value:function(){if(!this.mode)throw new Error("network 'mode' must be set, use setNetwork");return this.overhide_wallet.remuneration_uri[this.mode]}},{key:"getFromDollars",value:function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",100*t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,n,i){var o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.a.getTxs_check_details(t,r),o=t.address,u=this.getOverhideRemunerationAPIUri(),this.mode){e.next=5;break}throw new Error("network 'mode' must be set, use setNetwork");case 5:if(this.address){e.next=7;break}throw new Error("from 'address' not set: use setCredentials");case 7:return s=this.address,e.next=10,a.a.getTxs_retrieve(u,s,o,n,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=o(regeneratorRuntime.mark(function e(){var t,r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.mode){e.next=3;break}throw new Error("network 'mode' must be set, use setNetwork");case 3:if(this.address){e.next=5;break}throw new Error("from 'address' not set: use setCredentials");case 5:if(r=this.address,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return n="verify ownership of address by signing",e.next=11,this.sign(n);case 11:return i=e.sent,e.next=14,a.a.isSignatureValid_call(t,i,n,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=o(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.secret){t.next=2;break}throw new Error("credentials for imparter ".concat(e.tag," not set"));case 2:return t.abrupt("return",this.eth_accounts.sign(r,this.secret).signature);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,a){var i,o,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode){e.next=2;break}throw new Error("network 'mode' must be set, use setNetwork");case 2:if(this.address){e.next=4;break}throw new Error("from 'address' not set: use setCredentials");case 4:return i=this.address,o=this.getOverhideRemunerationAPIUri(),e.next=8,n.a.createTransaction(t,i,r,function(e){return u.sign(e)},function(e,t,r){return u.overhide_wallet.showOhLedgerGratisIframeUri(o,e,t,r)},this.overhide_wallet.oh_ledger_transact_fn[this.mode],a);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()}])&&u(t.prototype,r),i&&u(t,i),e}();s(c,"tag","ohledger"),t.a=c},function(t,r){t.exports=e},function(e,t,r){"use strict";var n=r(5),a=r.n(n),i=r(1),o=r(2);function u(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){u(i,n,a,o,s,"next",e)}function s(e){u(i,n,a,o,s,"throw",e)}o(void 0)})}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"eth_accounts",new a.a("http://localhost:8545").eth.accounts),l(this,"walletAddress",null),l(this,"network",null),l(this,"networkChangeDelegates",[]),this.addTag=t,this.removeTag=r,this.fire=n}var t,r,n;return t=e,(r=[{key:"detectWeb3Wallet",value:function(){var e=this;if(window.ethereum){s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.ethereum.enable();case 3:window.web3=new a.a(window.ethereum),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:return e.next=10,t();case 10:setInterval(s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:case"end":return e.stop()}},e)})),500);case 11:case"end":return e.stop()}},e,null,[[0,6]])}))();var t=function(){var t=s(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.web3.eth.getAccounts();case 3:return r=t.sent,n=r&&r.length>0?r[0]:null,t.next=7,window.web3.eth.net.getNetworkType();case 7:a=t.sent,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:a!==e.network&&(e.network=a,e.networkChangeDelegates.forEach(function(t){return t(e.network)})),n!==e.walletAddress&&(n?(e.addTag(i.a.tag),e.addTag(o.a.tag)):(e.removeTag(i.a.tag),e.removeTag(o.a.tag)),e.walletAddress=n,e.fire("onWalletChange",{imparterTag:i.a.tag,isPresent:!!n}),e.fire("onWalletChange",{imparterTag:o.a.tag,isPresent:!!n}),n&&(e.fire("onCredentialsUpdate",{imparterTag:i.a.tag,address:n}),e.fire("onCredentialsUpdate",{imparterTag:o.a.tag,address:n})));case 14:case"end":return t.stop()}},t,null,[[0,10]])}));return function(){return t.apply(this,arguments)}}()}}}])&&c(t.prototype,r),n&&c(t,n),e}();t.a=f},function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"resolve",null),u(this,"reject",null),u(this,"oh_ledger_transact_fn",{prod:null,test:null}),u(this,"remuneration_uri",{prod:"https://ledger.overhide.io/v1",test:"https://test.ledger.overhide.io/v1"}),window.addEventListener("message",function(e){e.data&&"oh-ledger-ok"===e.data.event?t.makePopupHidden(e.data.detail):e.data&&"oh-ledger-error"===e.data.event&&t.makePopupHidden(e.data.detail,!0)},!1),window.document.addEventListener("oh$-popup-close",function(e){t.makePopupHidden("user close",!0)})}var t,r,a;return t=e,(r=[{key:"raiseEventClick",value:function(e,t){window.parent.document.dispatchEvent(new CustomEvent("oh$-event",{detail:JSON.stringify({imparterTag:e,triggerFor:t,click:!0})}))}},{key:"raiseEvent",value:function(e,t,r){window.parent.document.dispatchEvent(new CustomEvent("oh$-event",{detail:JSON.stringify(i(i({},r),{},{imparterTag:e,triggerFor:t}))}))}},{key:"setupNewPromise",value:function(){var e=this;return console.assert(!this.resolve,"oh-popup promise being set but already set when calling setupNewPromise(..)"),new Promise(function(t,r){e.resolve=t,e.reject=r})}},{key:"makePopupVisible",value:function(){return document.getElementById("oh-popup-container").style.display="block",this.setupNewPromise()}},{key:"makePopupHidden",value:function(e,t){var r=document.getElementById("oh-popup-container");this.hideAllPopupContents(),r.style.display="none",console.assert(this.resolve,"oh-popup promise not set yet calling makePopupHidden(..)"),t?this.reject(e):this.resolve(e),this.resolve=null,this.reject=null}},{key:"hideAllPopupContents",value:function(){document.getElementById("oh-ledger-gratis-iframe").style.display="none"}},{key:"showOhLedgerGratisIframeUri",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t,r,n,a){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideAllPopupContents(),(i=document.getElementById("oh-ledger-gratis-iframe")).setAttribute("src","".concat(t,"/gratis.html?address=").concat(r,"&signature=").concat(n,"&message=").concat(a)),i.style.display="block",e.next=6,this.makePopupVisible();case 6:case"end":return e.stop()}},e,this)}),function(){var t=this,r=arguments;return new Promise(function(a,i){var o=e.apply(t,r);function u(e){n(o,a,i,u,s,"next",e)}function s(e){n(o,a,i,u,s,"throw",e)}u(void 0)})});return function(e,r,n,a){return t.apply(this,arguments)}}()},{key:"createPopup",value:function(){var e=this,t=document.createElement("div");t.setAttribute("id","oh-popup-container"),t.style.display="none",t.innerHTML='\n      <div>\n        <a href="#" title="Close" id="oh-popup-close" onclick="window.parent.document.dispatchEvent(new CustomEvent(\'oh$-popup-close\',{})); return false;">X</a>\n        <iframe id="oh-ledger-gratis-iframe"></iframe>\n      </div>\n    ';var r=document.createElement("style");r.innerHTML='\n      #oh-popup-container {\n          position: fixed;\n          font-family: arial, "lucida console", sans-serif;\n          top: 0;\n          right: 0;\n          bottom: 0;\n          left: 0;\n          background: rgba(0, 0, 0, 0.8);\n          z-index: 999;\n          opacity:1;\n          pointer-events: auto;\n      }\n      #oh-popup-container > div {\n          width: 80vw;\n          height: 75vh;\n          position: relative;\n          top: 15vh;\n          margin: auto auto;\n          padding: 5px 5px 5px 5px;\n          background: white;\n      }\n      #oh-popup-close {\n          background: grey;\n          color: white;\n          line-height: 25px;\n          position: absolute;\n          right: 2px;\n          text-align: center;\n          top: 2px;\n          width: 24px;\n          text-decoration: none;\n          font-weight: bold;\n      }\n      #oh-popup-close:hover {\n          background: black;\n      }\n\n      #oh-ledger-gratis-iframe {\n        display: none;\n        border: 0;\n        overflow: hidden;\n        width: 100%;\n        height: 100%;\n      }\n    ';!function n(){document.body?(document.body.appendChild(t),document.body.appendChild(r),e.loadOhLedgerTransactFns()):setTimeout(n,100)}()}},{key:"loadJS",value:function(e,t,r){var n=document.createElement("script");n.src=e,n.onload=t,n.onreadystatechange=t,r.appendChild(n)}},{key:"loadOhLedgerTransactFns",value:function(){var e=this;this.loadJS("".concat(this.remuneration_uri.prod,"/transact.js"),function(){var t=oh_ledger_transact;e.oh_ledger_transact_fn.prod=function(){return t.apply(void 0,arguments),e.setupNewPromise()}},document.body),this.loadJS("".concat(this.remuneration_uri.test,"/transact.js"),function(){var t=oh_ledger_transact;e.oh_ledger_transact_fn.test=function(){return t.apply(void 0,arguments),e.setupNewPromise()}},document.body)}}])&&o(t.prototype,r),a&&o(t,a),e}();t.a=s},function(e,t,r){"use strict";r.r(t),function(e){var n=r(1),a=r(2),i=r(4),o=r(6),u=r(7);function s(e,t,r,n,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function c(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)})}}function l(e){var t=p();return function(){var r,n=v(e);if(t){var a=v(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;return f(e)}(this,r)}}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){var t="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return d(e,arguments,v(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),w(n,e)})(e)}function d(e,t,r){return(d=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&w(a,r.prototype),a}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var y=function(){var t="object"==("undefined"==typeof self?"undefined":g(self))&&self.self===self&&self||"object"==(void 0===e?"undefined":g(e))&&e.global===e&&e||this||{};t.oh$=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(r,h(EventTarget));var t=l(r);function r(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return m(f(e=t.call.apply(t,[this].concat(a))),"enable",E),m(f(e),"getImparterTags",T),m(f(e),"canSetCredentials",P),m(f(e),"canGenerateCredentials",R),m(f(e),"canChangeNetwork",O),m(f(e),"generateCredentials",S),m(f(e),"setCredentials",C),m(f(e),"setNetwork",U),m(f(e),"getOverhideRemunerationAPIUri",L),m(f(e),"getCredentials",A),m(f(e),"getNetwork",D),m(f(e),"getFromDollars",$),m(f(e),"getTallyDollars",W),m(f(e),"getTally",H),m(f(e),"getTransactions",M),m(f(e),"isOnLedger",z),m(f(e),"sign",X),m(f(e),"createTransaction",Y),e}return r}());var r=null,s=new Promise(function(e){return r=e}),d=null,p=null,v=[i.a.tag];function b(e,t){var r=document.createEvent("Event");for(var n in r.initEvent(e,!0,!0),t)r[n]=t[n];y.dispatchEvent(r)}var k=new o.a(function(e){return function(e){-1==v.findIndex(function(t){return t===e})&&v.push(e)}(e)},function(e){return function(e){var t=v.findIndex(function(t){return t===e});t>-1&&v.splice(t,1)}(e)},function(e,t){return b(e,t)}),x=new u.a,_={};function E(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetcher:fetch}).fetcher;d=e,p=t,r(!0)}function T(){return v}function P(e){if(!e in _)throw new Error("invalid imparterTag");return _[e].canSetCredentials()}function R(e){if(!e in _)throw new Error("invalid imparterTag");return _[e].canGenerateCredentials()}function O(e){if(!e in _)throw new Error("invalid imparterTag");return _[e].canChangeNetwork()}function C(e,t){return j.apply(this,arguments)}function j(){return(j=c(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.abrupt("return",_[t].setCredentials(r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(e){if(!e in _)throw new Error("invalid imparterTag");return _[e].getCredentials()}function S(e,t){return N.apply(this,arguments)}function N(){return(N=c(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.abrupt("return",_[t].generateCredentials(r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(e,t){return I.apply(this,arguments)}function I(){return(I=c(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.abrupt("return",_[t].setNetwork(r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e){if(!e in _)throw new Error("invalid imparterTag");return _[e].getNetwork()}function L(e){if(!e in _)throw new Error("invalid imparterTag");return _[e].getOverhideRemunerationAPIUri()}function $(e,t){return F.apply(this,arguments)}function F(){return(F=c(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,s;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!p;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,_[t].getFromDollars(r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(e,t,r){return B.apply(this,arguments)}function B(){return(B=c(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,r,n,!0,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(e,t,r){return G.apply(this,arguments)}function G(){return(G=c(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,r,n,!0,!1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M(e,t,r){return q.apply(this,arguments)}function q(){return(q=c(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,r,n,!1,!1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J(e,t,r,n,a){return V.apply(this,arguments)}function V(){return(V=c(regeneratorRuntime.mark(function e(t,r,n,a,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,s;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!p;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,_[t].getTxs(r,n,a,i);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z(e){return K.apply(this,arguments)}function K(){return(K=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,s;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!p;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,_[t].isOnLedger();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X(e,t){return Q.apply(this,arguments)}function Q(){return(Q=c(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,s;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!p;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,_[t].sign(r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y(e,t,r,n){return Z.apply(this,arguments)}function Z(){return(Z=c(regeneratorRuntime.mark(function e(t,r,n,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in _)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,s;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!p;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,_[t].createTransaction(r,n,a);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}return _[n.a.tag]=new n.a(k,function(){return d},function(){return p.apply(void 0,arguments)},function(e,t){return b(e,t)}),_[a.a.tag]=new a.a(x,k,function(){return d},function(){return p.apply(void 0,arguments)},function(e,t){return b(e,t)}),_[i.a.tag]=new i.a(x,k,function(){return d},function(){return p.apply(void 0,arguments)},function(e,t){return b(e,t)}),x.createPopup(),k.detectWeb3Wallet(),t.oh$}();t.default=y}.call(this,r(9))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}])});
//# sourceMappingURL=ledgers.js.map