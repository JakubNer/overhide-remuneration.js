!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("web3")):"function"==typeof define&&define.amd?define("__oh$__",["web3"],t):"object"==typeof exports?exports.__oh$__=t(require("web3")):e.__oh$__=t(e.Web3)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise(function(a,i){var o=e.apply(t,r);function s(e){n(o,a,i,s,u,"next",e)}function u(e){n(o,a,i,s,u,"throw",e)}s(void 0)})}}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,r=null,n=[{key:"getTxs_check_details",value:function(e,t){if(t&&!(t instanceof Date))throw new Error("'date' must be a Date is passed in");if(!("address"in e&&e.address))throw new Error("'address' required in recipient")}},{key:"getTxs_retrieve",value:function(){var e=a(regeneratorRuntime.mark(function e(t,r,n,a,i,o,s,u){var c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 2:return c="",o&&(c="&since=".concat(o.toISOString())),l="",i&&(l="&tally-dollars=true"),e.next=8,u("".concat(t,"/get-transactions/").concat(r,"/").concat(n,"?tally-only=").concat(a?"true":"false").concat(l).concat(c,"&include-refunds=true"),{headers:new Headers({Authorization:"Bearer ".concat(s)})}).then(function(e){return e.json()}).catch(function(e){throw String(e)});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t,r,n,a,i,o,s,u){return e.apply(this,arguments)}}()},{key:"isSignatureValid_call",value:function(){var e=a(regeneratorRuntime.mark(function e(t,r,n,a,i,o){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("".concat(t,"/is-signature-valid"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(i)},body:JSON.stringify({signature:btoa(r),message:btoa(n),address:a})}).then(function(e){return 200==e.status}).catch(function(e){throw String(e)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,r,n,a,i,o){return e.apply(this,arguments)}}()}],r&&i(t.prototype,r),n&&i(t,n),e}();t.a=o},function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i;return t=e,r=null,i=[{key:"setNetwork_check_details",value:function(e){if(!("currency"in e))throw new Error("'currency' must be passed in");if(!("mode"in e))throw new Error("'mode' must be passed in");if(e.currency=e.currency.toUpperCase(),e.mode=e.mode.toLowerCase(),"USD"!==e.currency)throw new Error("'currency' must be 'USD'");if("prod"!==e.mode&&"test"!==e.mode)throw new Error("'mode' must be 'prod' or 'test'")}},{key:"createTransaction",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t,r,n,a,i,o,s){var u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t){e.next=14;break}if(!("message"in s&&s.message&&"signature"in s&&s.signature)){e.next=6;break}u=s.message,c=s.signature,e.next=10;break;case 6:return u="verify ownership of address by signing on ".concat((new Date).toLocaleString()),e.next=9,a(u);case 9:c=e.sent;case 10:return e.next=12,i(r,c,u);case 12:e.next=16;break;case 14:return e.next=16,o(t,r,n);case 16:case"end":return e.stop()}},e)}),function(){var t=this,r=arguments;return new Promise(function(a,i){var o=e.apply(t,r);function s(e){n(o,a,i,s,u,"next",e)}function u(e){n(o,a,i,s,u,"throw",e)}s(void 0)})});return function(e,r,n,a,i,o,s){return t.apply(this,arguments)}}()}],r&&a(t.prototype,r),i&&a(t,i),e}();t.a=i},function(e,t,r){"use strict";var n=r(0);function a(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)})}}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=function(){function e(t,r,n,a){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"remuneration_uri",{main:"https://ethereum.overhide.io",rinkeby:"https://rinkeby.ethereum.overhide.io"}),this.web3_wallet=t,this.eth_accounts=t.eth_accounts,this.getToken=r,this.__fetch=n,this.fire=a,t.networkChangeDelegates.push(function(e){return i.onNetworkChange(e)})}var t,r,a;return t=e,(r=[{key:"onNetworkChange",value:function(t){this.fire("onNetworkChange",{imparterTag:e.tag,name:t,mode:"main"==t?"prod":"test",uri:this.remuneration_uri[t]})}},{key:"canSetCredentials",value:function(){return!1}},{key:"canGenerateCredentials",value:function(){return!1}},{key:"canChangeNetwork",value:function(){return!1}},{key:"setCredentials",value:function(e){return!1}},{key:"getCredentials",value:function(){return{address:this.web3_wallet.walletAddress}}},{key:"generateCredentials",value:function(e){return!1}},{key:"setNetwork",value:function(e){return!1}},{key:"getNetwork",value:function(){return{name:this.web3_wallet.network,mode:"main"==this.web3_wallet.network?"prod":"test",uri:this.remuneration_uri[this.web3_wallet.network]}}},{key:"getOverhideRemunerationAPIUri",value:function(){return this.remuneration_uri[this.web3_wallet.network]}},{key:"getFromDollars",value:function(){var e=i(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="main"===this.web3_wallet.network?"":"test.",n=(new Date).toISOString(),e.next=4,this.__fetch("https://".concat(r,"rates.overhide.io/rates/wei/").concat(n),{headers:new Headers({Authorization:"Bearer ".concat(this.getToken())})}).then(function(e){return e.json()}).catch(function(e){throw String(e)});case 4:if((a=e.sent)&&0!==a.length&&!(!1 in a[0])&&0!==a[0].minrate){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",t/a[0].minrate);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=i(regeneratorRuntime.mark(function e(t,r,a,i){var o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.a.getTxs_check_details(t,r),o=t.address,s=this.getOverhideRemunerationAPIUri(),this.web3_wallet.network){e.next=5;break}throw new Error("network must be set in wallet");case 5:if(this.web3_wallet.walletAddress){e.next=7;break}throw new Error("from 'walletAddress' not set: use wallet");case 7:return u=this.web3_wallet.walletAddress,e.next=10,n.a.getTxs_retrieve(s,u,o,a,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=i(regeneratorRuntime.mark(function e(){var t,r,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.web3_wallet.network){e.next=3;break}throw new Error("no network for imparter tag");case 3:if(this.web3_wallet.walletAddress){e.next=5;break}throw new Error("from 'walletAddress' not set: use wallet");case 5:if(r=this.web3_wallet.walletAddress,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return a="verify ownership of address by signing",e.next=11,this.sign(a);case 11:return i=e.sent,e.next=14,n.a.isSignatureValid_call(t,i,a,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=i(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.web3_wallet.walletAddress){t.next=2;break}throw new Error("imparter ".concat(e.tag," not active"));case 2:return this.fire("onWalletPopup",{imparterTag:e.tag}),t.next=5,window.web3.eth.personal.sign(r,this.web3_wallet.walletAddress,"");case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var t=i(regeneratorRuntime.mark(function t(r,n,a){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.web3_wallet.network){t.next=2;break}throw new Error("no network for imparter tag");case 2:if(this.web3_wallet.walletAddress){t.next=4;break}throw new Error("from 'walletAddress' not set: use wallet");case 4:return i=this.web3_wallet.walletAddress,this.getOverhideRemunerationAPIUri(),this.fire("onWalletPopup",{imparterTag:e.tag}),t.next=9,new Promise(function(e,t){window.web3.eth.sendTransaction({from:i,to:n,value:r}).on("confirmation",function(t,r){e()}).on("error",function(e){t(e)})});case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}},t,this)}));return function(e,r,n){return t.apply(this,arguments)}}()}])&&o(t.prototype,r),a&&o(t,a),e}();s(u,"tag","eth-web3"),t.a=u},function(e,t,r){"use strict";var n=r(1),a=r(0);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)})}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t,r,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"mode","test"),this.web3_wallet=r,this.overhide_wallet=t,this.__fetch=a,this.getToken=n,this.fire=i}var t,r,i;return t=e,(r=[{key:"canSetCredentials",value:function(){return!1}},{key:"canGenerateCredentials",value:function(){return!1}},{key:"canChangeNetwork",value:function(){return!0}},{key:"setCredentials",value:function(e){return!1}},{key:"getCredentials",value:function(){return{address:this.web3_wallet.walletAddress}}},{key:"generateCredentials",value:function(e){return!1}},{key:"setNetwork",value:function(t){return n.a.setNetwork_check_details(t),this.mode=t.mode,this.fire("onNetworkChange",{imparterTag:e.tag,currency:"USD",mode:t.mode,uri:this.overhide_wallet.remuneration_uri[t.mode]}),!0}},{key:"getNetwork",value:function(){return{currency:"USD",mode:this.mode,uri:this.overhide_wallet.remuneration_uri[this.mode]}}},{key:"getOverhideRemunerationAPIUri",value:function(){if(!this.mode)throw new Error("network 'mode' must be set, use setNetwork");return this.overhide_wallet.remuneration_uri[this.mode]}},{key:"getFromDollars",value:function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",100*t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,n,i){var o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.a.getTxs_check_details(t,r),o=t.address,s=this.getOverhideRemunerationAPIUri(),this.mode){e.next=5;break}throw new Error("network 'mode' must be set, use setNetwork");case 5:if(this.web3_wallet.walletAddress){e.next=7;break}throw new Error("from 'walletAddress' not set: use wallet");case 7:return u=this.web3_wallet.walletAddress,e.next=10,a.a.getTxs_retrieve(s,u,o,n,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=o(regeneratorRuntime.mark(function e(){var t,r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.mode){e.next=3;break}throw new Error("network 'mode' must be set, use setNetwork");case 3:if(this.web3_wallet.walletAddress){e.next=5;break}throw new Error("from 'walletAddress' not set: use wallet");case 5:if(r=this.web3_wallet.walletAddress,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return n="verify ownership of address by signing",e.next=11,this.sign(n);case 11:return i=e.sent,e.next=14,a.a.isSignatureValid_call(t,i,n,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=o(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.web3_wallet.walletAddress){t.next=2;break}throw new Error("imparter ".concat(e.tag," not active"));case 2:return this.fire("onWalletPopup",{imparterTag:e.tag}),t.next=5,window.web3.eth.personal.sign(r,this.web3_wallet.walletAddress,"");case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,a){var i,o,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode){e.next=2;break}throw new Error("network 'mode' must be set, use setNetwork");case 2:if(this.web3_wallet.walletAddress){e.next=4;break}throw new Error("from 'walletAddress' not set: use wallet");case 4:return i=this.web3_wallet.walletAddress,o=this.getOverhideRemunerationAPIUri(),e.next=8,n.a.createTransaction(t,i,r,function(e){return s.sign(e)},function(e,t,r){return s.overhide_wallet.showOhLedgerGratisIframeUri(o,e,t,r)},this.overhide_wallet.oh_ledger_transact_fn[this.mode],a);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()}])&&s(t.prototype,r),i&&s(t,i),e}();u(c,"tag","ohledger-web3"),t.a=c},function(e,t,r){"use strict";var n=r(0);function a(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)})}}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=function(){function e(t,r,n,a){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"remuneration_uri",{prod:"https://bitcoin.overhide.io",test:"https://test.bitcoin.overhide.io"}),s(this,"url","http://localhost:8080/src/frames"),s(this,"address",null),s(this,"mode","test"),this.domFns=t,this.getToken=r,this.__fetch=n,this.fire=a,window.addEventListener("message",function(e){if(e.data&&e.data.event)switch(e.data.event){case"oh$-popup-signature":"detail"in e.data&&e.data.detail&&"signature"in e.data.detail?i.domFns.makePopupHidden(e.data.detail.signature,!1):i.domFns.makePopupHidden("no signature",!0)}})}var t,r,a;return t=e,(r=[{key:"canSetCredentials",value:function(){return!0}},{key:"canGenerateCredentials",value:function(){return!1}},{key:"canChangeNetwork",value:function(){return!0}},{key:"setCredentials",value:function(t){if(!("address"in t))throw new Error("'address' must be passed in");switch(this.mode){case"bitcoin_testnet":if(!/(tb(0([ac-hj-np-z02-9]{39}|[ac-hj-np-z02-9]{59})|1[ac-hj-np-z02-9]{8,87})|[mn2][a-km-zA-HJ-NP-Z1-9]{25,39})/.test(t.address))throw new Error("invalid bitcoin_testnet address: ".concat(t.address));break;case"bitcoin":if(!/(bc(0([ac-hj-np-z02-9]{39}|[ac-hj-np-z02-9]{59})|1[ac-hj-np-z02-9]{8,87})|[13][a-km-zA-HJ-NP-Z1-9]{25,35})/.test(t.address))throw new Error("invalid bitcoin address: ".concat(t.address))}return this.address=t.address,this.fire("onCredentialsUpdate",{imparterTag:e.tag,address:this.address}),!0}},{key:"getCredentials",value:function(){return{address:this.address}}},{key:"generateCredentials",value:function(e){return!1}},{key:"setNetwork",value:function(t){if(!("mode"in t))throw new Error("'mode' must be passed in");if(t.mode=t.mode.toLowerCase(),"prod"!==t.mode&&"test"!==t.mode)throw new Error("'mode' must be 'prod' or 'test'");return this.mode=t.mode,this.fire("onNetworkChange",{imparterTag:e.tag,mode:t.mode,uri:this.remuneration_uri[t.mode]}),!0}},{key:"getNetwork",value:function(){return{mode:this.mode,uri:this.remuneration_uri[this.mode]}}},{key:"getOverhideRemunerationAPIUri",value:function(){if(!this.mode)throw new Error("network 'mode' must be set, use setNetwork");return this.remuneration_uri[this.mode]}},{key:"getFromDollars",value:function(){var e=i(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="main"===this.mode?"":"test.",n=(new Date).toISOString(),e.next=4,this.__fetch("https://".concat(r,"rates.overhide.io/rates/sat/").concat(n),{headers:new Headers({Authorization:"Bearer ".concat(this.getToken())})}).then(function(e){return e.json()}).catch(function(e){throw String(e)});case 4:if((a=e.sent)&&0!==a.length&&!(!1 in a[0])&&0!==a[0].minrate){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",t/a[0].minrate);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=i(regeneratorRuntime.mark(function e(t,r,a,i){var o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.a.getTxs_check_details(t,r),o=t.address,s=this.getOverhideRemunerationAPIUri(),this.mode){e.next=5;break}throw new Error("network 'mode' must be set, use setNetwork");case 5:if(this.address){e.next=7;break}throw new Error("from 'address' not set: use setCredentials");case 7:return u=this.address,e.next=10,n.a.getTxs_retrieve(s,u,o,a,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=i(regeneratorRuntime.mark(function e(){var t,r,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.mode){e.next=3;break}throw new Error("network 'mode' must be set, use setNetwork");case 3:if(this.address){e.next=5;break}throw new Error("from 'address' not set: use setCredentials");case 5:if(r=this.address,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return a="verify ownership of address by signing",e.next=11,this.sign(a);case 11:return i=e.sent,e.next=14,n.a.isSignatureValid_call(t,i,a,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=i(regeneratorRuntime.mark(function t(r){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.address){t.next=2;break}throw new Error("credentials for imparter ".concat(e.tag," not set"));case 2:return this.domFns.hideAllPopupContents(),n=btoa(r),this.domFns.setFrame("".concat(this.url,"/btc_manual_sign.html?address=").concat(this.address,"&message=").concat(n,"&token=").concat(this.getToken(),"&isTest=").concat("test"==this.mode),70,40),t.t0=atob,t.next=8,this.domFns.makePopupVisible();case 8:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var e=i(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode){e.next=2;break}throw new Error("network 'mode' must be set, use setNetwork");case 2:if(this.address){e.next=4;break}throw new Error("from 'address' not set: use setCredentials");case 4:return this.address,this.domFns.hideAllPopupContents(),this.domFns.setFrame("".concat(this.url,"/btc_manual_createTransaction.html?from=").concat(this.address,"&to=").concat(r,"&value=").concat(t,"&isTest=").concat("test"==this.mode),70,45),e.next=9,this.domFns.makePopupVisible();case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()}])&&o(t.prototype,r),a&&o(t,a),e}();s(u,"tag","btc-manual"),t.a=u},function(e,t,r){"use strict";var n=r(1),a=r(0);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)})}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t,r,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"address",null),u(this,"secret",null),u(this,"mode","test"),this.overhide_wallet=t,this.eth_accounts=r.eth_accounts,this.getToken=n,this.__fetch=a,this.fire=i}var t,r,i;return t=e,(r=[{key:"canSetCredentials",value:function(){return!0}},{key:"canGenerateCredentials",value:function(){return!0}},{key:"canChangeNetwork",value:function(){return!0}},{key:"setCredentials",value:function(t){if(!("secret"in t))throw new Error("'secret' must be passed in");"address"in t&&t.address?this.address=t.address.toLowerCase():this.address=this.eth_accounts.privateKeyToAccount(t.secret).address.toLowerCase(),this.secret=t.secret;try{if(this.eth_accounts.recover(this.eth_accounts.sign("test message",this.secret)).toLowerCase()!=this.address)throw new Error("'secret' not valid for 'address")}catch(e){throw new Error("'secret' not valid for 'address")}return this.fire("onCredentialsUpdate",{imparterTag:e.tag,address:this.address,secret:this.secret}),!0}},{key:"getCredentials",value:function(){return{address:this.address,secret:this.secret}}},{key:"generateCredentials",value:function(t){var r=this.eth_accounts.create();return this.address=r.address.toLowerCase(),this.secret=r.privateKey,this.fire("onCredentialsUpdate",{imparterTag:e.tag,address:this.address,secret:this.secret}),!0}},{key:"setNetwork",value:function(t){return n.a.setNetwork_check_details(t),this.mode=t.mode,this.fire("onNetworkChange",{imparterTag:e.tag,currency:"USD",mode:t.mode,uri:this.overhide_wallet.remuneration_uri[t.mode]}),!0}},{key:"getNetwork",value:function(){return{currency:"USD",mode:this.mode,uri:this.overhide_wallet.remuneration_uri[this.mode]}}},{key:"getOverhideRemunerationAPIUri",value:function(){if(!this.mode)throw new Error("network 'mode' must be set, use setNetwork");return this.overhide_wallet.remuneration_uri[this.mode]}},{key:"getFromDollars",value:function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",100*t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,n,i){var o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.a.getTxs_check_details(t,r),o=t.address,s=this.getOverhideRemunerationAPIUri(),this.mode){e.next=5;break}throw new Error("network 'mode' must be set, use setNetwork");case 5:if(this.address){e.next=7;break}throw new Error("from 'address' not set: use setCredentials");case 7:return u=this.address,e.next=10,a.a.getTxs_retrieve(s,u,o,n,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=o(regeneratorRuntime.mark(function e(){var t,r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.mode){e.next=3;break}throw new Error("network 'mode' must be set, use setNetwork");case 3:if(this.address){e.next=5;break}throw new Error("from 'address' not set: use setCredentials");case 5:if(r=this.address,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return n="verify ownership of address by signing",e.next=11,this.sign(n);case 11:return i=e.sent,e.next=14,a.a.isSignatureValid_call(t,i,n,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var t=o(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.secret){t.next=2;break}throw new Error("credentials for imparter ".concat(e.tag," not set"));case 2:return t.abrupt("return",this.eth_accounts.sign(r,this.secret).signature);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,a){var i,o,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode){e.next=2;break}throw new Error("network 'mode' must be set, use setNetwork");case 2:if(this.address){e.next=4;break}throw new Error("from 'address' not set: use setCredentials");case 4:return i=this.address,o=this.getOverhideRemunerationAPIUri(),e.next=8,n.a.createTransaction(t,i,r,function(e){return s.sign(e)},function(e,t,r){return s.overhide_wallet.showOhLedgerGratisIframeUri(o,e,t,r)},this.overhide_wallet.oh_ledger_transact_fn[this.mode],a);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()}])&&s(t.prototype,r),i&&s(t,i),e}();u(c,"tag","ohledger"),t.a=c},function(e,t,r){"use strict";var n=r(1),a=r(0);function i(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,u,"next",e)}function u(e){i(o,n,a,s,u,"throw",e)}s(void 0)})}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){function e(t,r,n,a,i,o){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"address",null),u(this,"mode","test"),u(this,"social",null),this.domFns=t,this.overhide_wallet=r,this.eth_accounts=n.eth_accounts,this.getToken=a,this.__fetch=i,this.fire=o,window.addEventListener("message",function(e){if(e.data&&e.data.event)switch(e.data.event){case"oh$-login-success":s.domFns.makePopupHidden("login success",!1);break;case"oh$-login-failed":s.domFns.makePopupHidden("login failure",!0);break;case"oh$-logout-success":s.domFns.makePopupHidden("logout",!1)}})}var t,r,i;return t=e,(r=[{key:"canSetCredentials",value:function(){return!0}},{key:"canGenerateCredentials",value:function(){return!1}},{key:"canChangeNetwork",value:function(){return!0}},{key:"setCredentials",value:function(){var t=o(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=10;break}if(this.social){t.next=3;break}throw new Error("Not logged in");case 3:return this.domFns.hideAllPopupContents(),this.domFns.setFrame("https://overhide.b2clogin.com/overhide.onmicrosoft.com/B2C_1_".concat(this.social,"/oauth2/v2.0/logout?redirect_uri=https%3A%2F%2Fsocial.overhide.io%2Flogout")),t.next=7,this.domFns.makePopupVisible();case 7:this.address=null,t.next=17;break;case 10:if(!("provider"in r)){t.next=16;break}return this.social=r.provider,t.next=14,this.sign("setting credentials on ".concat(new Date));case 14:t.next=17;break;case 16:throw new Error("Incorrect credentials options.");case 17:return this.fire("onCredentialsUpdate",{imparterTag:e.tag,address:this.address}),t.abrupt("return",!0);case 19:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getCredentials",value:function(){return{address:this.address}}},{key:"generateCredentials",value:function(e){return!1}},{key:"setNetwork",value:function(t){return n.a.setNetwork_check_details(t),this.mode=t.mode,this.fire("onNetworkChange",{imparterTag:e.tag,currency:"USD",mode:t.mode,uri:this.overhide_wallet.remuneration_uri[t.mode]}),!0}},{key:"getNetwork",value:function(){return{currency:"USD",mode:this.mode,uri:this.overhide_wallet.remuneration_uri[this.mode]}}},{key:"getOverhideRemunerationAPIUri",value:function(){if(!this.mode)throw new Error("network 'mode' must be set, use setNetwork");return this.overhide_wallet.remuneration_uri[this.mode]}},{key:"getFromDollars",value:function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",100*t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTxs",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,n,i){var o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.a.getTxs_check_details(t,r),o=t.address,s=this.getOverhideRemunerationAPIUri(),this.mode){e.next=5;break}throw new Error("network 'mode' must be set, use setNetwork");case 5:if(this.address){e.next=7;break}throw new Error("from 'address' not set: use setCredentials");case 7:return u=this.address,e.next=10,a.a.getTxs_retrieve(s,u,o,n,i,r,this.getToken(),this.__fetch);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"isOnLedger",value:function(){var e=o(regeneratorRuntime.mark(function e(){var t,r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getOverhideRemunerationAPIUri(),this.mode){e.next=3;break}throw new Error("network 'mode' must be set, use setNetwork");case 3:if(this.address){e.next=5;break}throw new Error("from 'address' not set: use setCredentials");case 5:if(r=this.address,t){e.next=8;break}throw new Error("no uri for request, unsupported network selected in wallet?");case 8:return n="verify ownership of address by signing",e.next=11,this.sign(n);case 11:return i=e.sent,e.next=14,a.a.isSignatureValid_call(t,i,n,r,this.getToken(),this.__fetch);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=o(regeneratorRuntime.mark(function e(t){var r,n,a,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=this.eth_accounts.create(),n=r.privateKey,this.domFns.hideAllPopupContents(),this.domFns.setFrame("https://social.overhide.io/pending",30,10),a=this.domFns.makePopupVisible(),window.open("https://overhide.b2clogin.com/overhide.onmicrosoft.com/B2C_1_".concat(this.social,"/oauth2/v2.0/authorize?client_id=aa71ffc7-2884-4045-898f-7db3a177c1a1&response_type=code&redirect_uri=https%3A%2F%2Fsocial.overhide.io%2Fredirect/").concat(this.social,"&response_mode=query&scope=aa71ffc7-2884-4045-898f-7db3a177c1a1&state=").concat(n),"_blank",{height:300,width:300}),e.next=9,a;case 9:return e.next=11,this.__fetch("https://social.overhide.io/sign?karnet=".concat(n,"&message=").concat(btoa(t)),{method:"GET",headers:{"Content-Type":"application/json; charset=utf-8",Authorization:"Bearer ".concat(this.getToken())}}).then(function(){var e=o(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!=t.status){e.next=8;break}return e.next=3,t.json();case 3:return r=e.sent,i.address=r.address,e.abrupt("return",atob(r.signature));case 8:return e.t0=Error,e.next=11,t.text();case 11:throw e.t1=e.sent,new e.t0(e.t1);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 11:return e.abrupt("return",e.sent);case 14:throw e.prev=14,e.t0=e.catch(0),String(e.t0);case 17:case"end":return e.stop()}},e,this,[[0,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"createTransaction",value:function(){var e=o(regeneratorRuntime.mark(function e(t,r,a){var i,o,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mode){e.next=2;break}throw new Error("network 'mode' must be set, use setNetwork");case 2:if(this.address){e.next=4;break}throw new Error("from 'address' not set: use setCredentials");case 4:return i=this.address,o=this.getOverhideRemunerationAPIUri(),e.next=8,n.a.createTransaction(t,i,r,function(e){return s.sign(e)},function(e,t,r){return s.overhide_wallet.showOhLedgerGratisIframeUri(o,e,t,r)},this.overhide_wallet.oh_ledger_transact_fn[this.mode],a);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()}])&&s(t.prototype,r),i&&s(t,i),e}();u(c,"tag","ohledger-social"),t.a=c},function(t,r){t.exports=e},function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"resolve",null),o(this,"reject",null),window.addEventListener("message",function(e){if(e.data&&e.data.event)switch(e.data.event){case"oh$-popup-close":t.makePopupHidden("user close",!0)}})}var t,r,n;return t=e,(r=[{key:"init",value:function(){this.createPopup()}},{key:"raiseEventClick",value:function(e,t){window.parent.postMessage({event:"oh$-event",detail:JSON.stringify({imparterTag:e,triggerFor:t,click:!0})})}},{key:"raiseEvent",value:function(e,t,r){window.parent.postMessage({event:"oh$-event",detail:JSON.stringify(a(a({},r),{},{imparterTag:e,triggerFor:t}))})}},{key:"setupNewPromise",value:function(){var e=this;return console.assert(!this.resolve,"oh-popup promise being set but already set when calling setupNewPromise(..)"),new Promise(function(t,r){e.resolve=t,e.reject=r})}},{key:"setFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,n=document.getElementById("oh-ledger-iframe");n.setAttribute("src",e),n.style.display="block";var a=document.getElementById("oh-popup-container-div");a.style.width="".concat(t,"em"),a.style.height="".concat(r,"em")}},{key:"makePopupVisible",value:function(){return document.getElementById("oh-popup-container").style.display="block",this.setupNewPromise()}},{key:"makePopupHidden",value:function(e,t){var r=document.getElementById("oh-popup-container");this.hideAllPopupContents(),r.style.display="none",console.assert(this.resolve,"oh-popup promise not set yet calling makePopupHidden(..)"),t?this.reject(e):this.resolve(e),this.resolve=null,this.reject=null}},{key:"hideAllPopupContents",value:function(){document.getElementById("oh-ledger-iframe").style.display="none"}},{key:"createPopup",value:function(){var e=document.createElement("div");e.setAttribute("id","oh-popup-container"),e.style.display="none",e.innerHTML='\n      <div id="oh-popup-container-div">\n        <a href="#" title="Close" id="oh-popup-close" onclick="window.parent.postMessage({event: \'oh$-popup-close\'}); return false;">X</a>\n        <iframe id="oh-ledger-iframe"></iframe>\n      </div>\n    ';var t=document.createElement("style");t.innerHTML='\n      #oh-popup-container {\n          position: fixed;\n          font-family: arial, "lucida console", sans-serif;\n          top: 0;\n          right: 0;\n          bottom: 0;\n          left: 0;\n          background: rgba(0, 0, 0, 0.8);\n          z-index: 999;\n          opacity:1;\n          pointer-events: auto;\n      }\n      #oh-popup-container-div {\n          max-width: 80vw;\n          max-height: 75vh;\n          position: relative;\n          top: 15vh;\n          margin: auto auto;\n          padding: 5px 5px 5px 5px;\n          background: white;\n      }\n      #oh-popup-close {\n          background: grey;\n          color: white;\n          line-height: 25px;\n          position: absolute;\n          right: 2px;\n          text-align: center;\n          top: 2px;\n          width: 24px;\n          text-decoration: none;\n          font-weight: bold;\n      }\n      #oh-popup-close:hover {\n          background: black;\n      }\n\n      #oh-ledger-iframe {\n        display: none;\n        border: 0;\n        overflow: hidden;\n        width: 100%;\n        height: 100%;\n      }\n    ';!function r(){document.body?(document.body.appendChild(e),document.body.appendChild(t)):setTimeout(r,100)}()}}])&&i(t.prototype,r),n&&i(t,n),e}();t.a=s},function(e,t,r){"use strict";var n=r(7),a=r.n(n),i=r(2),o=r(3);function s(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){s(i,n,a,o,u,"next",e)}function u(e){s(i,n,a,o,u,"throw",e)}o(void 0)})}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"eth_accounts",new a.a("http://localhost:8545").eth.accounts),l(this,"walletAddress",null),l(this,"network",null),l(this,"networkChangeDelegates",[]),this.addTag=t,this.removeTag=r,this.fire=n}var t,r,n;return t=e,(r=[{key:"init",value:function(){this.detectWeb3Wallet()}},{key:"detectWeb3Wallet",value:function(){var e=this;if(window.ethereum){u(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.ethereum.enable();case 3:window.web3=new a.a(window.ethereum),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:return e.next=10,t();case 10:setInterval(u(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:case"end":return e.stop()}},e)})),500);case 11:case"end":return e.stop()}},e,null,[[0,6]])}))();var t=function(){var t=u(regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.web3.eth.getAccounts();case 3:return r=t.sent,n=r&&r.length>0?r[0]:null,t.next=7,window.web3.eth.net.getNetworkType();case 7:a=t.sent,t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:a!==e.network&&(e.network=a,e.networkChangeDelegates.forEach(function(t){return t(e.network)})),n!==e.walletAddress&&(n?(e.addTag(i.a.tag),e.addTag(o.a.tag)):(e.removeTag(i.a.tag),e.removeTag(o.a.tag)),e.walletAddress=n,e.fire("onWalletChange",{imparterTag:i.a.tag,isPresent:!!n}),e.fire("onWalletChange",{imparterTag:o.a.tag,isPresent:!!n}),n&&(e.fire("onCredentialsUpdate",{imparterTag:i.a.tag,address:n}),e.fire("onCredentialsUpdate",{imparterTag:o.a.tag,address:n})));case 14:case"end":return t.stop()}},t,null,[[0,10]])}));return function(){return t.apply(this,arguments)}}()}}}])&&c(t.prototype,r),n&&c(t,n),e}();t.a=d},function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"oh_ledger_transact_fn",{prod:null,test:null}),i(this,"remuneration_uri",{prod:"https://ledger.overhide.io/v1",test:"https://test.ledger.overhide.io/v1"}),i(this,"attach",function(){document.body?r.loadOhLedgerTransactFns():setTimeout(r.attach,100)}),this.domFns=t,window.addEventListener("message",function(e){e.data&&"oh-ledger-ok"===e.data.event?r.domFns.makePopupHidden(e.data.detail):e.data&&"oh-ledger-error"===e.data.event&&r.domFns.makePopupHidden(e.data.detail,!0)},!1)}var t,r,o;return t=e,(r=[{key:"init",value:function(){this.attach()}},{key:"showOhLedgerGratisIframeUri",value:function(){var e,t=(e=regeneratorRuntime.mark(function e(t,r,n,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.domFns.hideAllPopupContents(),this.domFns.setFrame("".concat(t,"/gratis.html?address=").concat(r,"&signature=").concat(n,"&message=").concat(a)),e.next=4,this.domFns.makePopupVisible();case 4:case"end":return e.stop()}},e,this)}),function(){var t=this,r=arguments;return new Promise(function(a,i){var o=e.apply(t,r);function s(e){n(o,a,i,s,u,"next",e)}function u(e){n(o,a,i,s,u,"throw",e)}s(void 0)})});return function(e,r,n,a){return t.apply(this,arguments)}}()},{key:"loadJS",value:function(e,t,r){var n=document.createElement("script");n.src=e,n.onload=t,n.onreadystatechange=t,r.appendChild(n)}},{key:"loadOhLedgerTransactFns",value:function(){var e=this;this.loadJS("".concat(this.remuneration_uri.prod,"/transact.js"),function(){var t=oh_ledger_transact;e.oh_ledger_transact_fn.prod=function(){return t.apply(void 0,arguments),e.domFns.setupNewPromise()}},document.body),this.loadJS("".concat(this.remuneration_uri.test,"/transact.js"),function(){var t=oh_ledger_transact;e.oh_ledger_transact_fn.test=function(){return t.apply(void 0,arguments),e.domFns.setupNewPromise()}},document.body)}}])&&a(t.prototype,r),o&&a(t,o),e}();t.a=o},function(e,t,r){"use strict";r.r(t),function(e){var n=r(8),a=r(2),i=r(4),o=r(3),s=r(5),u=r(6),c=r(9),l=r(10);function d(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function f(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var i=e.apply(t,r);function o(e){d(i,n,a,o,s,"next",e)}function s(e){d(i,n,a,o,s,"throw",e)}o(void 0)})}}function h(e){var t=v();return function(){var r,n=b(e);if(t){var a=b(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;return p(e)}(this,r)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){var t="function"==typeof Map?new Map:void 0;return(w=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return m(e,arguments,b(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),g(n,e)})(e)}function m(e,t,r){return(m=v()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&g(a,r.prototype),a}).apply(null,arguments)}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var x=function(){var t="object"==("undefined"==typeof self?"undefined":y(self))&&self.self===self&&self||"object"==(void 0===e?"undefined":y(e))&&e.global===e&&e||this||{};t.oh$=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,w(EventTarget));var t=h(r);function r(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return k(p(e=t.call.apply(t,[this].concat(a))),"enable",C),k(p(e),"getImparterTags",O),k(p(e),"canSetCredentials",A),k(p(e),"canGenerateCredentials",j),k(p(e),"canChangeNetwork",N),k(p(e),"generateCredentials",I),k(p(e),"setCredentials",S),k(p(e),"setNetwork",L),k(p(e),"getOverhideRemunerationAPIUri",z),k(p(e),"getCredentials",U),k(p(e),"getNetwork",H),k(p(e),"getFromDollars",B),k(p(e),"getTallyDollars",V),k(p(e),"getTally",q),k(p(e),"getTransactions",J),k(p(e),"isOnLedger",Q),k(p(e),"sign",ee),k(p(e),"createTransaction",re),e}return r}());var r=null,d=new Promise(function(e){return r=e}),m=null,v=null,b=[s.a.tag,u.a.tag,i.a.tag];function _(e,t){var r=document.createEvent("Event");for(var n in r.initEvent(e,!0,!0),t)r[n]=t[n];x.dispatchEvent(r)}var T=new n.a,P=new c.a(function(e){return function(e){-1==b.findIndex(function(t){return t===e})&&b.push(e)}(e)},function(e){return function(e){var t=b.findIndex(function(t){return t===e});t>-1&&b.splice(t,1)}(e)},function(e,t){return _(e,t)}),R=new l.a(T),E={};function C(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetcher:fetch}).fetcher;m=e,v=t,r(!0)}function O(){return b}function A(e){if(!e in E)throw new Error("invalid imparterTag");return E[e].canSetCredentials()}function j(e){if(!e in E)throw new Error("invalid imparterTag");return E[e].canGenerateCredentials()}function N(e){if(!e in E)throw new Error("invalid imparterTag");return E[e].canChangeNetwork()}function S(e,t){return F.apply(this,arguments)}function F(){return(F=f(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.abrupt("return",E[t].setCredentials(r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(e){if(!e in E)throw new Error("invalid imparterTag");return E[e].getCredentials()}function I(e,t){return D.apply(this,arguments)}function D(){return(D=f(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.abrupt("return",E[t].generateCredentials(r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function L(e,t){return $.apply(this,arguments)}function $(){return($=f(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.abrupt("return",E[t].setNetwork(r));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(e){if(!e in E)throw new Error("invalid imparterTag");return E[e].getNetwork()}function z(e){if(!e in E)throw new Error("invalid imparterTag");return E[e].getOverhideRemunerationAPIUri()}function B(e,t){return G.apply(this,arguments)}function G(){return(G=f(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,d;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!v;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,E[t].getFromDollars(r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V(e,t,r){return M.apply(this,arguments)}function M(){return(M=f(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t,r,n,!0,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(e,t,r){return W.apply(this,arguments)}function W(){return(W=f(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t,r,n,!0,!1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J(e,t,r){return K.apply(this,arguments)}function K(){return(K=f(regeneratorRuntime.mark(function e(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t,r,n,!1,!1);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Z(e,t,r,n,a){return X.apply(this,arguments)}function X(){return(X=f(regeneratorRuntime.mark(function e(t,r,n,a,i){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,d;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!v;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,E[t].getTxs(r,n,a,i);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q(e){return Y.apply(this,arguments)}function Y(){return(Y=f(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,d;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!v;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,E[t].isOnLedger();case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ee(e,t){return te.apply(this,arguments)}function te(){return(te=f(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,d;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!v;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,E[t].sign(r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function re(e,t,r,n){return ne.apply(this,arguments)}function ne(){return(ne=f(regeneratorRuntime.mark(function e(t,r,n,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!t in E)){e.next=2;break}throw new Error("invalid imparterTag");case 2:return e.next=4,d;case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}e.t0=!v;case 7:if(!e.t0){e.next=9;break}throw new Error("did you forget to `oh$.enable(..)`?");case 9:return e.next=11,E[t].createTransaction(r,n,a);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}return E[a.a.tag]=new a.a(P,function(){return m},function(){return v.apply(void 0,arguments)},function(e,t){return _(e,t)}),E[i.a.tag]=new i.a(T,function(){return m},function(){return v.apply(void 0,arguments)},function(e,t){return _(e,t)}),E[o.a.tag]=new o.a(R,P,function(){return m},function(){return v.apply(void 0,arguments)},function(e,t){return _(e,t)}),E[s.a.tag]=new s.a(R,P,function(){return m},function(){return v.apply(void 0,arguments)},function(e,t){return _(e,t)}),E[u.a.tag]=new u.a(T,R,P,function(){return m},function(){return v.apply(void 0,arguments)},function(e,t){return _(e,t)}),T.init(),P.init(),R.init(),t.oh$}();t.default=x}.call(this,r(12))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}])});
//# sourceMappingURL=ledgers.js.map